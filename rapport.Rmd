---
title: "Rapport d'analyse - Census Income"
author: "IF36 - Inspecteur Gadget"
date: "UTT - Semestre P23"

output:
  rmdformats::material:
    thumbnails: false
    gallery: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)
```

```{css}
.header-panel {
  background: linear-gradient(to right, #aa42c9, #6f8fac, #54abaa);
}

.pages h1 {
  color: #aa42c9;
}

a {
  color: #6f8fac;
}

code {
  color: #6f8fac;
}
```

```{r libraries, include=FALSE}
library(readr)
library(dplyr)
library(tidyr)
library(ggplot2)
library(usmap)
library(scales)
```

```{r data, include=FALSE}
data <- read_csv("data/census-income.csv")
data$race <- gsub("Asian or Pacific Islander", "Asian/Pacific", data$race)
data$race <- gsub("Amer Indian Aleut or Eskimo", "Natives", data$race)
hispanic_latino <- c("Mexican (Mexicano)", "Puerto Rican", "Cuban", "Central or South American", "Other Spanish", "Chicano", "Mexican-American")
data$race <- ifelse(data$hispanic_origin %in% hispanic_latino, "Hispanic/Latino", data$race)
```

# Introduction

Extrait du recensement de la population américaine effectué en 1994-1995, ce jeu de données contient les données d’un peu moins de 200 000 individus, réparties sur 40 variables. Ces données proviennent du Département du Commerce des États-Unis; nous sommes donc en présence de données qui s'attachent principalement à décrire des données démographiques et sur l'emploi.

À l'origine, ce jeu de données a été publié par Ronny Kohavi et Barry Becker (Data Mining and Visualization, Silicon Graphics) avec pour objectif de prédire si un individu gagne plus de 50 000 dollars par an, dans le cadre du machine learning.

Il est disponible sur le site de l'[UCI Machine Learning Repository](https://archive.ics.uci.edu/dataset/20/census+income).



## Données

Ce dataset contient 199 523 observations et 42 variables. 

Pour chaque variable, les personnes recensées les ont remplies si elles étaient concernées. La liste des variables est la suivante :

- `age` : âge
- `class_of_worker` : type de l'emploi (gouvernement, auto-entrepreneur, privé)
- `detailed_industry_recode` : code de l'industrie où la personne travaille ([liste des codes](https://microdata.epi.org/variables/indocc/dind03/))
- `detailed_occupation_recode` : code du domaine de l'emploi de la personne ([liste des codes](https://www.icpsr.umich.edu/web/RCMD/studies/03303/datasets/0001/variables/PRDTOCC1?archive=RCMD))
- `education` : niveau d'éducation (lycée, université, ...)
- `wage_per_hour` : salaire mensuel (et non horaire comme précédemment indiqué)
- `enroll_in_edu_inst_last_wk` : inscription à une école la semaine dernière (lycée, université, ...)
- `marital_stat` : statut marital (marié, divorcé, veuf, ...)
- `major_industry_code` : nom de l'industrie principale où travaille la personne (agriculture, éducation, administration, ...)
- `major_occupation_code` : domaine de l'emploi principal de la personne (vente, pêche, forces armées, ...)
- `race` : ethnie (blanc, noir, asiatique, ...)
- `hispanic_origin` : pays d'origine de la personne (si elle est hispanique)
- `sex` : sexe (masculin, féminin)
- `member_of_a_labor_union` : appartenance à un syndicat (oui, non)
- `reason_for_unemployment` : raison du chômage (licenciement, départ, ...)
- `full_or_part_time_employment_stat` : statut d'emploi à temps plein ou partiel (temps plein, temps partiel (avec justification), ...)
- `capital_gains` : gains en capital
- `capital_losses` : pertes en capital
- `dividends_from_stocks` : dividendes des actions
- `tax_filer_stat` : statut de déclaration d'impôt (couple, célibataire, non déclarant, ...)
- `region_of_previous_residence` : région de la résidence précédente (nord, sud, est, ouest, à l'étranger)
- `state_of_previous_residence` : état de la résidence précédente (Floride, Californie, ...)
- `detailed_household_and_family_stat` : statut détaillé de la famille (exemple : enfant de + de 18 ans jamais marié)
- `detailed_household_summary_in_household` : statut détaillé de la famille dans le ménage (exemple : épouse du chef du ménage)
- `instance_weight` : poids de l'instance (pour la pondération, en fonction de la probabilité de l'observation)
- `migration_code-change_in_msa` : changement résidentiel, dans une zone métropolitaine différente
- `migration_code-change_in_reg` : changement résidentiel, dans une région différente mais dans le même pays
- `migration_code-move_within_reg` : changement résidentiel, dans la même région mais dans un autre état
- `live_in_this_house_1_year_ago` : habite dans la même maison depuis au moins un an
- `migration_prev_res_in_sunbelt` : changement résidentiel où la résidence précédente était dans le sud des États-Unis
- `num_persons_worked_for_employer` : nombre de personnes travaillant pour l'employeur de la personne
- `family_members_under_18` : Quand concerne des personnes ayant moins de 18ans, précise les membres de la famille présent (père, mère ou les deux)
- `country_of_birth_father` : pays de naissance du père de la personne
- `country_of_birth_mother` : pays de naissance de la mère de la personne
- `country_of_birth_self` : pays de naissance de la personne
- `citizenship` : citoyenneté (née aux États-Unis, née à l'étranger, ...)
- `own_business_or_self_employed` : propriétaire d'une entreprise ou auto-entrepreneur
- `fill_inc_questionnaire_for_veteran_admin` : a rempli un questionnaire de revenus pour l'administration des anciens combattants (oui, non)
- `veterans_benefits` : possède des avantages pour anciens combattants (oui, non)
- `weeks_worked_in_year` : nombre de semaines travaillées dans l'année
- `year` : année du recensement
- `income_level` : niveau de revenu (inférieur à 50k, supérieur à 50k)

Plus d'informations sur la signification des variables sont disponibles sur le site du [Census Bureau](https://www.census.gov/).


## Présentation du jeu de données


### Répartition par âge

Commençons donc avec la répartition par âge de notre échantillon.

```{r age_distribution}
ggplot(data, aes(x = age)) +
    geom_histogram(binwidth = 5) +
    labs(title = "Répartition des âges", x = "Âge", y = "Nombre de personnes")
```


On remarque ainsi que la majeure partie de l'échantillon a moins de 45 ans. Il existe néanmoins de fortes disparités ; l'engagement des États-Unis dans la guerre du Vietnam, notamment à partir de 1965 explique en partie ces écarts démographiques. Les classes d'âge qui se sont majoritairement enrolés au Vietnam ont entre 40 et 50  au moment de l'enquête, et on peut constater leur sous-représenatation dans la population générale. En mobilisant plus de 2 millions de soldats, dont la moyenne d'âge était de 19 ans, la guerre a en effet fait un peu moins de 60 000 morts du côté américain.

Un déficit des naissances est aussi observé pour les classes d'âges allant de 12 à 30 ans, avec un pic vers 20 ans ; ce sont des naissances "manquantes", qui n'ont pas eu lieu à cause de l'absence des hommes enrolés dans la guerre.

Ce déficit s'observe aussi sur la pyramide des âges.
De plus, le jeu de données est à l'origine utilisé pour faire du machine learning afin de prédire la tranche de salaire en fonction d'autres paramètres. Ainsi, les individus les plus pertinents à interroger se situent entre 20 et 60ans, en sachant que le taux d'emploi décroit mécaniquement avec l'avancée en âge. 

### Pyramide des âges

```{r pyramide}
ages <- data %>%
    mutate(age_range = cut(age,
        breaks = seq(min(data$age), max(data$age), 5), include.lowest = TRUE
    ))

ggplot(data = ages, aes(x = as.factor(age_range), fill = sex)) +
    geom_bar(data = subset(ages, sex == "Female")) +
    geom_bar(
        data = subset(ages, sex == "Male"),
        aes(y = after_stat(count) * (-1))
    ) +
    coord_flip() +
    labs(title = "Pyramide des âges", x = "Âge", y = "Nombre de personnes", fill = "Genre")
```

On peut aussi constater que les femmes vivent plus longtemps que les hommes, puisqu'elles représentent par exemple 3/4 de la classe d'âge 85-90 ans. Une hygiène de vie plus favorable, avec moins de tabac ou d'alcool, peut en partie expliquer cet écart.

### Ethnies et pays de naissance

```{r race}
race_percent <- data %>%
    mutate(race = gsub("Asian or Pacific Islander", "Asian/Pacific", race)) %>%
    mutate(race = gsub("Amer Indian Aleut or Eskimo", "Natives", race)) %>%
    group_by(race) %>%
    count(race) %>%
    ungroup() %>%
    mutate(percentage = n / sum(n))

ggplot(race_percent, aes(x = race, y = percentage)) +
    geom_bar(stat = "identity") +
    scale_y_continuous(labels = percent_format()) +
    labs(title = "Distribution des ethnies", x = "Ethnies", y = "Distribution")
```

On constate que l'écrasante majorité de la population interrogée est caucasienne. 

A titre de comparaison, la population américaine en 1995 était répartie de la manière suivante (source : Census) :

- +70% de la population était causasienne

- 12% de la population était noire

- 10% de la population était hispanique**

- 3% de la population était asiatique

* *hispanique est ici utilisé comme un abus de language pour parler des populations originaire d'Amérique Latine et Centrale.*

L’échantillon semble donc être globalement représentatif de la population américaine en 1994, avec tout de même une proportion de personnes noires légèrement moindre. 

On s'intéresse désormais aux pays de naissance des personnes interrogées dans notre échantillon.

```{r birthcountrybar, fig.width = 9}
counts <- table(data$country_of_birth_self)
nb_etats_unis <- counts["United-States"]
nb_autres_pays <- sum(counts) - nb_etats_unis

graph_data <- data.frame(
  Pays = c("États-Unis", "Autres"),
  Fréquence = c(counts["United-States"], sum(counts) - counts["United-States"])
)

ggplot(data = graph_data, aes(x = Fréquence, y = Pays, fill = Pays)) +
  geom_bar(stat = "identity", width = 0.5) +
  xlab("Fréquence") +
  ylab("Pays") +
  ggtitle("Comparaison du nombre de personnes ayant les EU comme pays de naissance et le reste")
```

On constate, sans surprise, que l'écrasante majorité de la population interrogée est née aux États-Unis. 




## Plan d'analyse

La présence de données ethniques est une des spécificités de ce jeu de données. Celles-ci ne sont en effet pas présentes dans les données issues des instituts français, empêchant de facto l'étude des inégalités liées à la race* sur une grande échelle.


Nous avons donc décidé de profiter de la présence de l’attribut ethnique ("race") pour étudier l’impact de l’appartenance à un groupe racisé* sur la situation économique de la personne, et plus particulièrement sur son revenu.

Nous essaierons d’affiner notre analyse en croisant nos résultats avec d’autres données: 

- Le sexe ; Est-ce un facteur d’aggravation des inégalités raciales ?

- La situation géographique ; Le lieu de résidence (la Sunbelt par exemple) influe-t-il sur le niveau de vie et la qualité des emplois ?

- Le statut marital et la situation familiale ; Le mariage profite-t-il économiquement aux individus ? On pourra aussi pondérer les revenus en fonction du nombre de personnes composant les foyers.

- temporel (générations); Les enfants américains nés de parents étrangers sont-ils mieux intégrés au marché de l’emploi que leurs parents avant eux ?



Enfin, nous nous attacherons à essayer de comprendre les inégalités économiques. Pour cela nous nous pencherons sur les données structurelles :

- Le niveau scolaire; La poursuite d’études permet-elle l’accès aux plus hauts revenus ? Élimine-t-elle le travail précaire ?

- La qualité de l’emploi (nombre de semaines travaillées, salaire mensuel, cause du chômage, domaine d’activité, syndicat,); L’ethnie a-t-elle un impact sur les postes occupés et la rémunération des individus ?
 
- Le capital



Il est tout de même important de noter que les données datent des années 90 et que les visualisations que nous allons réaliser ne seront pas forcément représentatives de la situation actuelle. Il sera donc nécessaire de replacer ces visualisations dans le contexte de l'époque afin de les interpréter correctement.


> *NB : “race” est un mot de vocabulaire employé dans le champ de la recherche en sociologie, en France comme aux États-Unis. 





# Exploration

Pour commencer, comme ce jeu de données est d'abord un recencement de la population américaine, il nous semble important d'en comprendre les principales caractéristiques (âge, sexe, origine) afin de dresser un portrait de l'américain moyen en 1994.

Quand nous pensons aux inégalités aux Etats-Unis, nous pensons tout d'abord aux inégalités raciales qui touchent les populations afro-américaines. Nous allons donc commencer notre exploration par cet aspect des inégalités. 


 
## Les inégalités raciales
### Niveau de revenu en fonction de l'ethnie

```{r levelracepercentage}
income_percent <- data %>%
  group_by(income_level) %>%
  count(race) %>%
  mutate(percentage = n / sum(n))

ggplot(income_percent, aes(x = income_level, y = percentage, fill = race)) +
  geom_bar(position = "dodge", stat = "identity") +
  scale_y_continuous(labels = percent_format()) +
  labs(
    title = "Répartition des ethnies en fonction du niveau de revenu",
    fill = "Ethnies",
    x = "Niveau de revenu",
    y = "Pourcentage"
  )
```

Avec ce graphique, on constate qu'il existe bien des inégalités raciales au niveau du salaire. Alors que les populations caucasiennes sont, en proportion, plus représentés dans les salaires supérieurs à 50 000 dollars mensuels, c'est l'inverse pour les populations noires et latinos/hispaniques. En effet, leur proportion triple dans la tranche des -50000$ annuels par rapport à celle des +50000$ annuels. Ces deux types de populations sont celles qui semblent être les plus touchées par les inégalités de revenus. 

De l'autre côté, les populations en provenance d'Asie sont un peu mieux représentées dans les salaires à +50000 dollars que dans les salaires à -50000 dollars. 

### Salaire mensuel et ethnie

```{r wage_per_hour}
wage <- data %>%
  filter(wage_per_hour != 0 & race != "Other" & age < 75)

average_income_by_age_race <-
  aggregate(wage_per_hour ~ age + race, data = wage, FUN = mean)

ggplot(data = average_income_by_age_race, aes(
  x = age, y = wage_per_hour,
  color = race
)) +
  geom_smooth(se = FALSE, formula = y ~ x, method = "loess") +
  geom_vline(xintercept = 40, linetype = "dashed", color = "red") +
  geom_vline(xintercept = 55, linetype = "dashed", color = "red") +
  labs(
    title = "Salaire mensuel moyen en fonction de l'âge et de l'ethnie",
    x = "Âge", y = "Salaire mensuel",
    color = "Ethnie"
  )
```

Plusieurs phénomènes apparaissent sur ce graphique. Nous allons tout d'abord nous intéresser à l'allure globale des courbes. Nous pouvons en effet noter que les courbes sont concaves. Il semblerait ainsi que le salaire mensuel croit jusqu'à un certain âge puis décroit. Cette décroissance peut être analysée comme une anomalie car, dans de nombreuses études, il est montré que le salaire mensuel croit jusqu'à l'âge de la retraite, ce qui n'est pas le cas ici. Il semblerait cependant que nous soyons ici face à un effet de génération. En effet si l'on se renseigne sur l'évolution du salaire moyen aux États-Unis, nous apprenons que le salaire mensuel moyen a progressivement évolué pendant la Seconde Guerre Mondiale avant de connaître une importante hausse dans les années 60. Les personnes entrées dans l'emploi dans ces années là correspondent, de manière générale, aux personnes nées entre 1940 et 1955. Ces personnes sont donc agées, lors de l'enquête, de 40 à 55 ans. Ces âges correspondent aux points hauts de quatre courbes. Ces personnes ont bénéficié d'un salaire mensuel de départ plus important que leurs prédécesseurs qui n'a cessé de progresser avec l'expérience. 

Ce phénomène d'augmentation du salaire avec l'âge est visible sur la partie montante de la courbe concave. En effet, le salaire augmente souvent avec l'expérience. 

Nous allons maintenant nous intéresser aux différences entre les ethnies. Tout d'abord nous constatons que le salaire mensuel moyen maximum des personnes Afro-Américaines est plus faible que celui des autres ethnies. Cela peut s'expliquer par un racisme encore bien ancré dans la société américaine des années 90 qui se traduit par une discrimination à l'emploi. De même, les personnes latinos/hispaniques ont des revenus peu supérieurs à ceux des personnes Afro-Américaines. L'important flux migratoire venant de l'Amérique Centrale et du Sud a fait paraître ces individus comme des indésirables pour de nombreux Americains blancs qui sont plus fréquemment à la tête d'entreprises. De plus, nous pouvons supposer que les personnes Afro-américaines et latinos/hispaniques sont plus représentées dans des secteurs peu rémunérateurs.

Pour ce qui est du salaire moyen des populations amérindiennes, leur faible représentation dans notre jeu de données peut amener à des valeurs faussées ou peu représentatives de la réalité. 

Néanmoins les population asiatiques ont le plus haut salaire mensuel moyen, dépassant ainsi le seuil des 1250 dollars mensuels après 40 ans. Cette différence pourrait s'expliquer par plusieurs facteurs. Tout d'abord une immigration sélective : seules les populations au plus haut capital social, culturel et économique ont eu les moyens d'immigrer aux États-Unis. La tontine, sorte d'épargne communautaire aidant à financer les projets des membres, est aussi bien développé. On peut aussi supposer que ce haut salaire est corrélé à un plus fort taux d'études, dans des secteurs mieux rémunérés. C'est ce que nous allons vérifier.

### Ethnie et secteur d'activité

```{r industry_race}
industry <- data %>%
  filter(major_industry_recode != "Not in universe or children")

ggplot(industry, aes(y = major_industry_recode, fill = race)) +
  geom_bar() +
  labs(x = "Nombre", y = "Type de branche", fill = "Ethnie")
```

On constate encore une fois que le nombre de personnes caucasiennes du jeu de données nuit à la lisibilité de nos graphiques axés sur les personnes racisées. Nous allons donc sélectionner seulement les personnes racisées. 

```{r industry_race2}
industry2 <- data %>%
  filter(major_industry_recode != "Not in universe or children" & race != "White")

ggplot(industry2, aes(y = major_industry_recode, fill = race)) +
  geom_bar() +
  labs(x = "Nombre", y = "Type de branche", fill = "Ethnie")
```


```{r industry_wage2}
education_order <- c(
    "Less than 1st grade",
    "1st 2nd 3rd or 4th grade",
    "5th or 6th grade",
    "7th and 8th grade",
    "9th grade",
    "10th grade",
    "11th grade",
    "12th grade no diploma",
    "High school graduate",
    "Some college but no degree",
    "Associates degree-occup /vocational",
    "Associates degree-academic program",
    "Bachelors degree(BA AB BS)",
    "Masters degree(MA MS MEng MEd MSW MBA)",
    "Prof school degree (MD DDS DVM LLB JD)",
    "Doctorate degree(PhD EdD)"
)

education <- data %>%
  filter(wage_per_hour != 0) %>%
  filter(education != "Children") %>%
  mutate(education = factor(
    education,
    levels = education_order
  )) %>%
  group_by(education, race, sex, major_industry_recode) %>%
  summarise(wage_per_hour = mean(wage_per_hour))

ggplot(education, aes(y = major_industry_recode, x = wage_per_hour)) +
  geom_bar(stat = "summary") +
  labs(
    title = "Salaire mensuel moyen par industrie",
    x = "Salaire mensuel moyen", y = "Type de branche")  
```

Nous pouvons constater que les branches où travaillent majoritairement les personnes racisées qui subissent le plus les inégalités de salaire ne sont pas les branches les plus rémunératrices (retail trade, public administration, manufacturing non-durable and durable goods, education).

Nous allons alors nous intéresser à la variance des salaires dans ces branches. 

```{r industry_wage3}
ggplot(education, aes(y = major_industry_recode, x = wage_per_hour)) +
  geom_boxplot() +
  labs(
    title = "Salaire mensuel par branche",
    x = "Salaire mensuel", y = "Branche"
  )
```

Nous pouvons remarquer ici, sur les branches qui nous intéressent (retail trade, public administration, manufacturing non-durable and durable goods, education) les salaires médians sont loin d’être les plus conséquents, avec des points isolés qui montrent une variance importante entre les quelques gros salaires et le reste. Nous pouvons supposer ici que les personnes afro-américaines ou latinos/hispaniques se situent sous le salaire médian. 

Maintenant que nous avons vu que les secteurs d’activités étaient répartis de manière inégales entre population racisée et non racisée, nous allons pouvoir nous concentrer sur la position des personnes dans leur travail. 

### Ethnie et type d'activité

```{r occupation_race_W, fig.width = 5}
occupation <- data %>%
  filter(major_occupation_recode != "Not in universe or children" & major_occupation_recode != "Not in universe" & major_occupation_recode != "Other service"  &  major_occupation_recode != "Armed Forces")

ggplot(occupation, aes(y = major_occupation_recode, fill = race)) +
  geom_bar() +
  labs(x = "Nombre", y = "Type de branche", fill = "Ethnie")
```

Pour une meilleure lisibilité, on analyse ce même schéma, mais sans les populations caucasiennes : 


```{r occupation_race, fig.width = 5}
occupation <- data %>%
  filter(major_occupation_recode != "Not in universe or children" & major_occupation_recode != "Not in universe" & major_occupation_recode != "Other service"  &  major_occupation_recode != "Armed Forces" & race != "White")

ggplot(occupation, aes(y = major_occupation_recode, fill = race)) +
  geom_bar() +
  labs(x = "Nombre", y = "Type d'activité", fill = "Ethnie")
```

Pour comprendre l'écart de salaire moyen que nous avions pu constater plus tôt, entre les populations noires et asiatiques par exemple, il peut être intéressant d'analyser leur domaine d'activité. Les populations asiatiques sont en effet sureprésentées dans la catégorie "spécialité professionnel". Même si le terme reste flou, on peut comprendre que c'est un domaine d'expertise bien précis, qui demande des connaissances bien précises - et qui est sûrement mieux rémunéré que les autres emplois.

Les populations noires sont elles plutôt représentés dans le support administratif, domaine qui paye peut-être moins bien.
Le secteur d'activité peut donc avoir un rôle déterminant sur les perspectives de salaire, et est l'une des causes des différences salariales entre ethnies.
Les populations latinos hispaniques sont elles plus présentes dans le domaine administratif, dans les emplois de supervision dans les usines (contre-maîtres) mais aussi dans la mécanique de précision. Comme nous l'avons dit plus haut, le domaine administratif, même aux Etats-Unis, n'est pas celui qui paie le mieux. De même, les contre-maîtres dans l'industrie américaine ne sont pas des postes à forte valeur ajoutée, ainsi les salaires restent faibles. Enfin, la mécanique de précision est un domaine peu valorisé d'un point de vue salarial. 

Nous allons pouvoir nous intéresser à l’aspect scolaire des inégalités entre les ethnies. 

### Ethnie et capital scolaire

```{r education_race}
ggplot(education, aes(y = education, fill = race)) +
    geom_bar(position = "fill") +
    labs(fill = "Ethnie")
```

On constate ici que jusqu’au High school diploma les personnes racisées sont autant présentes que les personnes caucasiennes, voir même sont majoritaires dans certains cas. Cependant cette tendance s’inverse pour les diplômes les plus valorisés (et les plus longs à obtenir) que sont les prof school degree, master degree ou bien encore phD. Or nous avons vu tout à l’heure que ces diplômes étaient les plus rémunérateurs. De plus, certaines populations comme les amérindiens ne sont pas représentés dans les niveaux de diplomes les plus élevés. 
La présence des personnes noires dans les études allant de master à doctorat s'explique principalement par la mise en place de quotas par les universités (discrimination positive) dès les années 1960. De plus, la minorité afro-américaine est la plus grosse minorité des Etats-Unis, ce qui signifie qu'elle a un poids électoral indéniable. De même pour les populations hispaniques et latinos, qui bénéficient ainsi elles aussi des systèmes de quotas. Cependant ce n'est pas le cas des populations natives qui n'ont pas été intégrées au système de discrimination positive dans le domaine éducatif américain. 


## Etats-Unis et migrations

### La Sunbelt

```{r sunbelt}
wage <- data %>%
    filter(wage_per_hour != 0 & age <= 70)

average_wph_by_age <-
    aggregate(wage_per_hour ~ age + migration_previous_residence_in_sunbelt, data = wage, FUN = mean)

wage_sunbelt <- average_wph_by_age %>%
    filter(migration_previous_residence_in_sunbelt == "Yes")

ggplot() +
    geom_smooth(data = wage_sunbelt, aes(x = age, y = wage_per_hour, color = "Sunbelt"), se = FALSE) +
    geom_smooth(data = wage, aes(x = age, y = wage_per_hour, color = "US"), se = FALSE) +
    labs(
        title = "Salaire mensuel moyen en fonction de l'âge et du lieu de résidence",
        x = "Âge", y = "Salaire mensuel moyen",
        color = "Lieu de résidence"
    )
```

Nous pouvons constater que les personnes ayant habités dans la SunBelt ont un salaire moyen inférieur à celui de l'ensemble des Américains. Cela peut s'expliquer par plusieurs choses. D'une part, notre jeu de données ne nous permet pas de connaître l'Etat de résidence de chaque personne intérrogée. En revanche, nous connaissons leur Etat précédent de résidence. Ainsi nous nous sommes focalisés sur les personnes ayant habitées dans la Sunbelt pour faire ce graphique. Or la Sunbelt est une terre qui a un passé esclavagiste. Encore aujourd'hui, 158ans après la fin de la guerre de Secession, ces racines sont encore présentes. Les Républicains sont relativement bien implantés dans ces Etats, encore de nos jours. 
Ces aspects politique et culturel ont pu entrainer des migrations des personnes racisées qui apparaissent comme seules personnes reliées à un Etat de la Sunbelt dans notre jeu de données (du fait de l'absence de l'Etat de résidence). 

La deuxième explication vient du fait que les Etats de la Sunbelt, dans les années 90, avaient pour activité économique principale l'agriculture qui génère de moindres revenus. A cela s'ajoutait le tourisme et la pêche, qui emploient des personnes avec des salaires relativement faibles.  L'industrie automobile venait de faire son apparition dans ces Etats, tout comme le domaine des hautes technologies qui n'était qu'à son balbutiement. 

### Pays de naissance

```{r birthcountry, fig.height=8}
ggplot(data, aes(y = country_of_birth_self)) +
    geom_bar() +
    labs(
        title = "Pays de naissance",
        x = "Nombre d'individus", y = "Pays"
    )
```

Les pays de naissance des personnes interrogées sont donc variés, avec une large majorité de personnes nées aux Etats-Unis.

Quelques pays comme le Mexique semblent néanmoins se distinguer du fait de sa proximité avec les États-Unis (frontière commune). Il convient aussi de noter que le Mexique traverse une grave crise économique qui débute fin 1994. Cette information peut être mise en perspective avec les débats des années 2010 sur la construction d'un mur à la frontière entre les États-Unis et le Mexique pour endiguer le flux migratoire venant du Mexique et plus généralement de l'Amérique latine.  

Pour mieux appréhender la pluralité des pays d'origine des immigrés, voici donc un autre graphique, qui exclut cette fois-ci les États-Unis.

### Pays de naissance - Hors États-Unis

```{r birthcountrynous, fig.height=8}
no_us <- data %>%
    filter(country_of_birth_self != "United-States" & country_of_birth_self != "?")

ggplot(no_us, aes(y = country_of_birth_self)) +
    geom_bar() +
    labs(
        title = "Pays de naissance",
        x = "Nombre d'individus", y = "Pays"
    )
```

On a cette fois-ci une vision plus claire des pays de naissance. On constate une assez grande diversité géographique, puisque presques tous les continents sont représentés ; l'Amérique du Sud ( Mexique, Salvador, etc), l'Asie (Vietnam, Laos,Philippines,Inde, Japon,etc) mais aussi l'Europe (Italie,Allemagne).

Au niveau des proportions, le Mexique s'impose assez largement comme 1er pays de naissance (hors États-Unis) de la population. Attirée par un pays voisin au niveau de vie supérieur, on peut aisément supposer qu'une partie de la population mexicaine a fait le choix de s'installer aux États-Unis. On retrouve de la même manière plusieurs pays latino-américains comme Puerto-Rico ou Cuba en haut du classement.

Le rayonnement culturel des États-Unis, accentué par les politiques mises en place durant la Guerre Froide, a fait apparaître le pays comme un nouvel Eldorado, et a attiré les populations du monde entier en quête d'un avenir meilleur.

La forte présence de population née en Allemagne pourrait, elle, être expliquée par une émigration durant la 2nde Guerre mondiale, notamment chez les populations de confession juive. A cela s'ajoutent les Allemands souhaitant prendre un nouveau départ au crépuscule de la 2nd Guerre mondiale et à l'aube de la Guerre froide qui divise leur pays. 

### Immigration et génération

Nous allons nous intéresser à l'insertion des personnes issues de l'immigration. 

```{r insertion_race, fig.width = 9}
average_wph_by_age_country <-
    aggregate(wage_per_hour ~ age + country_of_birth_self + country_of_birth_father + country_of_birth_mother, data = wage, FUN = mean)

hors_us <- average_wph_by_age_country %>%
    filter(country_of_birth_self != "United-States")

us_parents <- average_wph_by_age_country %>%
    filter(country_of_birth_self == "United-States" &
        (country_of_birth_father != "United-States" |
            country_of_birth_mother != "United-States"))

ggplot() +
    geom_smooth(data = hors_us, aes(x = age, y = wage_per_hour, color = "Hors US"), se = FALSE) +
    geom_smooth(data = us_parents, aes(x = age, y = wage_per_hour, color = "US dont au moins 1 des parents est né hors US"), se = FALSE) +
    labs(
        title = "Salaire mensuel moyen en fonction de l'âge et du lieu de naissance",
        x = "Âge", y = "Salaire mensuel moyen",
        color = "Lieu de naissance"
    )
```
    
Nous remarquons ici que les personnes qui viennent d'immigrer aux Etats-Unis ont un salaire inférieur aux personnes dont au moins un des deux parents a immigré aux Etats-Unis. Ainsi on constate que l'intégration des personnes issues de pays autres que les Etats-Unis se fait dans le temps et sur plusieurs générations. Le temps de vie dans le pays influence donc les inégalités. "L'American Dream" n'est pas à effet immédiat. 

### Carte des États-Unis représentant les Etats précédents de résidence

```{r maptwo}
previous_residence_data <- data %>%
    filter(state_of_previous_residence != "Not in universe" &
        state_of_previous_residence != "?") %>%
    group_by(state_of_previous_residence) %>%
    summarise(count = n()) %>%
    arrange(desc(count)) %>%
    rename(state = state_of_previous_residence)

plot_usmap(
    data = previous_residence_data,
    values = "count"
) +
    scale_fill_continuous(
        low = "white", high = "#DC143C",
    ) +
    theme(legend.position = "right") +
    labs(
        title = "Etat précédent de résidence",
        fill = "Nombre d'individus"
    )
```

*Nous n'avions pas assez de données sur les États de Wasgington et Hawaï, et ils sont donc en gris sur la carte*

La Californie, l'Utah, la Floride et la Caroline du Nord comptent pour les Etats les plus représentés dans la population sondée.

La Californie (30 millions d'habitants en 1994) et la Floride (31 millions) sont en effet les Etats les plus peuplés des États-Unis, et il n'est pas étonnant de les retrouver sur cette carte. De plus, le gouverneur de Californie Pete Wilson (Républicain) en poste en 1994 s'est lancé dans une croisade contre les immigrés de son Etat. La Proposition 187 de Californie était une proposition de loi controversée qui a été soumise au vote des électeurs en Californie lors des élections de novembre 1994. Son titre officiel était l'« Initiative de la loi sur l'immigration illégale ». Elle visait à restreindre l'accès des immigrants sans papiers aux services publics, tels que l'éducation et les soins de santé. Un débat a été engagé sur la constitutionnalité de cette loi. Cependant, de nombreuses personnes issues de l'immigration ont préféré quitter l'Etat.  La présence de l'Utah est plus surprenante, alors qu'en 1994 la population de cet Etat n'excédait par les 2 millions de personnes. On peut faire le même constat pour la Caroline du nord, et ses 7 millions d'habitants.

On peut faire plusieurs conjonctures pour expliquer cette carte. Tout d'abord, il faut rappeler que malgré sa volonté d'être représentative de la population américaine, ce recensement ne se base "que" sur 200 000 personnes, et qu'il peut donc y avoir des biais, surtout géographiques. On n'a en effet pas les lieux où les enquêtes ont été majoritairement menées, et il est possible qu'il y ait eu un plus fort taux de réponses dans certains Etats comme l'Utah qu'ailleurs.

Deuxième piste, les données portaient sur l'Etat de "précédente résidence" ; on peut donc faire l'hypothèse que les habitants de l'Utah et de la Caroline du Nord sont plus souvent partis de ces Etats pour s'installer dans d'autres. La forte population dans certains Etats ne seraient pas donc dû à un solde naturel positif de naissance inter-étatique, mais bien à des mobilités de population à l'échelle nationale.

Ces suppositions sont évidemment insuffisantes pour expliquer ce décalage, mais elles nous permettent de nous apporter quelques pistes de réflexions, et surtout de garder à l'esprit de toujours s'interroger sur la provenance des données.


Passons maintenant au deuxième type d'inégalités qui sont présentes dans nos sociétés: les inégalités de genre. 


## Inégalités de genre

### Niveau de revenu en fonction du genre

```{r incomesex}
ggplot(data, aes(x = income_level, fill = sex)) +
    geom_bar(position = "fill") +
    labs(x = "Niveau de revenu", y = "Nombre d'individus", fill = "Genre")
```

Les catégories de revenu sont divisées en deux, soit moins de 50 000 dollars par an, soit plus que 50 000 dollars par an, puisque le jeu de données ne comporte pas de données plus précises.
Le revenu moyen d'un foyer américain en 1990 était en effet de 50 000 dollars annuel, ce qui rend le choix de cette valeur pertinent pour avoir un rapide aperçu de la situation financière des personnes interrogés dans le cadre de cette étude. On suppose donc que c'est pour cette raison qu'elle a été incluse dans le jeu de données.
 
Si on analyse néanmoins les résultats, on constate qu'une majeure partie des sondés gagne moins de 50 000 dollars par an, et qu'une minorité seulement arrive à avoir un travail plus rémunérateur. Lorsqu'on parlait plus tôt de "foyer", on peut néanmoins préciser que ceux-ci sont en général constitués de plus d'une personne, et quand plus de 70% des femmes travaillent en 1990, le revenu du foyer est en général constitué de 2 salaires. Cette distinction peut permettre de mieux comprendre pourquoi une large partie de la population interrogées demeure donc sous le seuil des 50 000 dollars de revenus annuel.

On constate tout de même que la répartition des salaires entre les deux genres n'est pas la même. Parmi les populations les plus favorisés (plus de 50 000 dollars par an), seul un quart sont des femmes. Au contraire, elles représentent plus de la moitié de ceux gagnant moins de 50 000 dollars par mois. 

### Taux d'emploi par genre

```{r incomesexgender}
major <- data %>%
  filter(age > 14)

taux_emploi <- aggregate(full_or_part_time_employment_stat ~ sex, data = major, FUN = function(x) {
    taux <- sum(x == "Full-time schedules" |
        x == "PT for econ reasons usually PT" |
        x == "PT for econ reasons usually FT" |
        x == "PT for non-econ reasons usually FT") / length(x)
})

ggplot(data = taux_emploi) +
    geom_bar(aes(x = sex, y = full_or_part_time_employment_stat), stat = "identity", fill = "Purple", width = 0.5) +
    xlab("Genre") +
    ylab("Taux d'emploi (%)") +
    ggtitle("Taux d'emploi chez les hommes et les femmes")
```

Pour expliquer cette différence, on constate d'abord que le taux d'emploi des femmes est inférieur à celui des hommes. Cela pourrait en partie expliquer l'écart salarial remarqué plus haut. 

Néanmoins cette première explication n'est pas entièrement suffissante, et nous tenterons donc de trouver les causes de cette inégalité de revenus ; on s'intéressera dans la suite à l'impact de l'éducation, mais aussi du choix du secteur d'activité, qui pourraient apporter des pistes d'explications.

```{r wagesex}
 wage <- data %>%
  filter(wage_per_hour != 0 & race != "Other" & age < 76)
average_wph_by_age_sex <-
  aggregate(wage_per_hour ~ age + sex, data = wage, FUN = mean)

ggplot(data = average_wph_by_age_sex, aes(
  x = age, y = wage_per_hour,
  color = sex
)) +
  geom_smooth(se = FALSE, formula = y ~ x, method = "loess") +
  labs(
    title = "Salaire mensuel moyen en fonction de l'âge et du genre",
    x = "Âge", y = "Salaire mensuel moyen",
    color = "Genre"
  )
```

Cet écart de revenu entre les hommes et les femmes peut ainsi s'expliquer de plusieurs manières. Premièrement, le salaire mensuel d'une femme est souvent inférieur à celui d'un homme - à poste équivalent, âge équivalent, expérience et formation équivalentes. En effet il est intériosé que les femmes vont avoir des enfants et seront donc moins impliquées dans leur travail. De plus, lorsque ces mêmes enfants seront malades, il y a de fortes chances que cela soit la conjointe qui prenne des congés pour s'occuper d'eux.

### Le genre du travail

Deuxièmement, l'éducation est très souvent genrée. De ce fait, les femmes sont souvent orientées vers des filières qui leur "correspondent" (stéréotype de genres) comme par exemple les métiers du "care" - car les femmes sont vues comme naturellement douées pour s'occuper des autres. Or ces filières genrées avec des métiers identifiés comme féminins sont les filières peu rémunératrices. (Duru Bellat, Kieffer, Marry, 2001, *La dynamique des scolarités des filles*. 

```{r industry-genre}
industry <- data %>%
    filter(major_industry_recode != "Not in universe or children")

ggplot(industry, aes(y = major_industry_recode, fill = sex)) +
    geom_bar() +
    labs(x = "Nombre d'invividus", y = "Secteur d'activité", fill = "Genre")
```


Nous pouvons constater ici que les femmes sont majoritairement présentes dans les domaines tels que les services sociaux, l’hôpital et plus généralement le domaine médical (souvent dans des postes d’infirmières), ainsi que dans le domaine éducatif - du fait de stéréotype de genre qui font qu'elles sont considérées comme plus à même d'éduquer des enfants du fait de "l'instinct maternel". Le domaine des services sociaux est peu rémunérateur, mais ceux de la médecine (en hôpital ou en dehors des hôpitaux) sont dans les plus rémunérateur. Cependant ce secteur représente une grande variété de métiers. 

Il convient tout de même de noter que les femmes sont aussi majoritaires présentes dans le domaine regroupant finance, assurance et immobilier qui est généralement très rémunérateur. 

```{r industrie-wage-boxplot, fig.width=8}
ggplot(education, aes(y = major_industry_recode, x = wage_per_hour)) +
    geom_boxplot() +
    labs(
        title = "Variance du salaire mensuel en fonction du secteur d’activité",
        x = "Variance du salaire mensuel", y = "Secteur d’activité"
    )
```

En effet, les branches médicales en hôpital et hors hôpital ont une grande variance, et nous pouvons supposer que les femmes occupent des métiers d’infirmières moins rémunérés que leurs collègues médecins. Cette supposition peut être appuyée par la suite du fait de la faible proportion de femme détenant un diplôme MD (qui est nécessaire pour exercer en tant que médecin).


```{r gender-sector-precisely, fig.width=7}
education <- data %>%
    filter(wage_per_hour != 0) %>%
    filter(education != "Children") %>%
    filter(major_industry_recode == "Education" |
        major_industry_recode == "Hospital services" |
        major_industry_recode == "Medical except hospital") %>%
    mutate(education = factor(
        education,
        levels = education_order
    )) %>%
    group_by(education, race, sex, major_industry_recode) %>%
    summarise(wage_per_hour = mean(wage_per_hour), count = n())

ggplot(education, aes(x = major_industry_recode, y = wage_per_hour, fill = major_industry_recode)) +
    geom_bar(stat = "summary") +
    facet_wrap(~sex) +
    labs(
        title = "Salaire mensuel moyen en fonction du genre et du secteur d'activité",
        x = "Secteur d'activité", y = "Salaire mensuel moyen",
        fill = "Secteur d'activité"
    )
```

On constate en effet que pour deux des trois secteurs, les salaires moyens des femmes sont effectivement plus faibles que ceux des hommes. Cette différence est très visible sur le salaire mensuel. En supposant que les hommes et les femmes travaillent le même nombre d’heures. 
    
Or, comme on le constate ici, les femmes ont tendance à plus être en temps partiel que les hommes. En effet, ces dernières doivent généralement s'occuper des enfants et du travail domestique en plus de leur travail rémunéré. Cela explique aussi en partie leur choix de s'orienter vers des métiers plus pratiques (Duru-Bellat, 1990, *L'Ecole des filles*).  De plus, en reprenant nos précédentes explications (salaire mensuel inférieur), il est plus rationnel que cela soit la femme qui renonce à une partie du travail rémunéré car le coût d'opportunité sera moindre (expliqué par Gary Becker, 1981, *A Treaty on the Family*).


### Femmes et temps de travail (rémunéré)

```{r employment-time}
employment_stat <- data %>%
    filter(full_or_part_time_employment_stat != "Not in labor force" &
        full_or_part_time_employment_stat != "Unemployed full-time" &
        full_or_part_time_employment_stat != "Unemployed part- time" &
        full_or_part_time_employment_stat != "Children or Armed Forces") %>%
    mutate(full_or_part_time_employment_stat = gsub("PT for non-econ reasons usually FT", "Part-time", full_or_part_time_employment_stat)) %>%
    mutate(full_or_part_time_employment_stat = gsub("PT for econ reasons usually PT", "Part-time", full_or_part_time_employment_stat)) %>%
    mutate(full_or_part_time_employment_stat = gsub("PT for econ reasons usually FT", "Part-time", full_or_part_time_employment_stat)) %>%
    mutate(full_or_part_time_employment_stat = gsub("Full-time schedules", "Full-time", full_or_part_time_employment_stat))

ggplot(employment_stat, aes(x = full_or_part_time_employment_stat, fill = sex)) +
    geom_bar(position = "fill") +
    labs(title = "Type d'activité en fonction du genre", x = "Type d'activité", y = "Nombre de personnes", fill = "Genre")
```

Ce coût d’opportunité peut aussi expliquer une auto-censure des femmes dans leurs études. En effet, pourquoi investir (avec du temps et surtout de l’argent) dans l'éducation alors qu’on gagnera moins que son mari ? 

### Femmes et niveau scolaire
On constate que la part de femme en fonction du niveau d’étude va en diminuant, et qu’une large majorité des personnes qui ont arrêté leurs études au 1st grade (école élémentaire) sont… des femmes. Au vu des prix de l'éducation aux États-Unis, les parents peuvent aussi choisir d'éduquer et d'investir sur un enfant en particulier, en général un garçon, au détriment du reste de sa fratrie.

La plus grande disparité entre hommes et femmes se fait au niveau MD et au niveau PhD, les deux niveaux d'études les plus rémunérateurs. 


```{r education-sex}
education <- data %>%
    filter(wage_per_hour != 0) %>%
    filter(education != "Children") %>%
    mutate(education = factor(
        education,
        levels = education_order
    )) %>%
    group_by(education, race, sex, major_occupation_recode) %>%
    summarise(wage_per_hour = mean(wage_per_hour))

ggplot(education, aes(y = education, fill = sex)) +
  geom_bar(position = "fill")+
geom_vline(xintercept = 0.5, linetype = "dashed", color = "yellow")+
labs(fill = "Genre")
```

Pour ce qui est de la corrélation entre diplôme et salaire par mensuel, on constate que le salaire croit en fonction du niveau du diplôme. Or, comme nous l’avons dit précédemment, les femmes sont moins enclines à continuer leurs études du fait d’un coût d’opportunité plus élevé que leurs homologues masculins. C’est en quelques sorte le serpent qui se mord la queue.

```{r wage_education}
ggplot(education, aes(x = wage_per_hour, y = education)) +
    geom_bar(stat = "summary") +
    labs(
        title = "Salaire mensuel par niveau scolaire",
        x = "Salaire mensuel", y = "Niveau scolaire"
    )
```

Cependant, nous pouvons aussi dire que, au-delà de questions pécuniaires, un haut niveau de diplôme va avoir un certain prestige social (capital symbolique pour reprendre les notions de Bourdieu). De ce prisme, nous pouvons constater de nouvelles inégalités entre hommes et femmes du fait de la moindre présence féminine dans les docteurs (diplômes d’un doctorat (PhD)).




Les différences salariales entre les femmes et les hommes sont donc dues à de multiples facteurs. Tout d'abord, les femmes sont moins nombreuses à avoir un emploi rémunéré que les hommes. Quand elles en ont un, celui-ci est plus à temps partiel, et est effectué dans des secteurs d'activité peu rémunérateur. De plus, leur plus faible taux de poursuite d'études ne les aide pas à atteindre des postes aux salaires plus attractifs.





# Conclusion
Après avoir étudié le profil de notre échantillon et l'avoir mis en perspective avec les données démographiques de l'époque, il nous a semblé pertinent de nous interroger sur les dicriminations pouvant exister aux États-Unis, notamment celles basées sur l'ethnie ou le sexe.
Les résultats sont sans équivoque ; ces facteurs ont une importance sur l'éducation, le choix de domaine d'activité, et in fine sur le salaire.

Il est néanmoins intéressant de voir que certaines minorités ethniques ont malgré tout réussi à obtenir de hauts salaires moyens, et à accumuler du capital économique, voire scolaire. Au delà de l'ethnie, il pourrait donc y avoir un vrai enjeu à soutenir les populations les plus défavorisées en leur permettant l'accès à l'éducation, qui elle-même peut aider à obtenir de meilleurs salaires.

Malheureusement, presque 30 ans plus tard, les choses ne semblent pas avoir énormément évoluées. Les populations noires sont toujours les plus touchées par la pauvreté, et ont un revenu médian bien inférieur à d'autres groupes ethniques (caucasiens, asiatiques).

De plus, il convient de remarquer que les inégalités de genre et de races non seulement s'accumulent, mais elles peuvent aussi se multiplier. Les femmes noires sont par exemple sujettes à plus d'inégalités, d'une part parce que ce sont des femmes, et d'autre part parce qu'elles sont noires. En témoigne cette courbe représentant les salaires mensuels selon l'âge, le genre et l'ethnie.

```{r intersectionnalité}
wage_nozero_young <- data %>%
    filter(wage_per_hour != 0) %>%
    filter(age <= 67)

avg_wph_last <-
    aggregate(wage_per_hour ~ age + sex + race, data = wage_nozero_young, FUN = mean)

white_men <- avg_wph_last %>%
    filter(race == "White" & sex == "Male")

white_women <- avg_wph_last %>%
    filter(race == "White" & sex == "Female")

black_men <- avg_wph_last %>%
    filter(race == "Black" & sex == "Male")

black_women <- avg_wph_last %>%
    filter(race == "Black" & sex == "Female")

ggplot() +
    geom_smooth(data = white_men, se = FALSE, aes(x = age, y = wage_per_hour, color = "Hommes caucasiens")) +
    geom_smooth(data = white_women, se = FALSE, aes(x = age, y = wage_per_hour, color = "Femmes caucasiennes")) +
    geom_smooth(data = black_men, se = FALSE, aes(x = age, y = wage_per_hour, color = "Hommes noirs")) +
    geom_smooth(data = black_women, se = FALSE, aes(x = age, y = wage_per_hour, color = "Femmes noires")) +
    labs(
        title = "Salaire mensuel moyen des différentes ethnies en fonction de l'âge",
        x = "Âge", y = "Salaire mensuel moyen",
        color = "Ethnies"
    )
```


La situation prend même un tournant innatendu avec l'apparition des nouvelles technologies, comme l'intelligence artificielle. Ce jeu de données par exemple, a été utilisé à des fins de machine learning. En analysant ces données, l'IA pourrait donc considérer que ces différences ethniques sont une norme sociale qu'il convient d'appliquer. Il y a donc un vrai risque qu'elle reproduise et accentue ces discriminations. Nous devons donc impérativement prendre conscience de ces nouveaux enjeux, afin de pas accentuer un cercle vicieux qui viserait à perpétuer ces inégalités. 

Pour conclure et pour expliciter cela, nous reprendrons une citation de Giuseppe Tomasi di Lampedusa qui s'adapte bien aux limites de cette révolution qu'est l'intelligence artificielle : "Se vogliamo che tutto rimanga come è, bisogna che tutto cambi" / "Si nous voulons que tout reste pareil, il faut que tout change".


